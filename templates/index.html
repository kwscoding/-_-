<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì˜ë‹¨ì–´ ì•”ê¸°ì¥</title>
    <link rel="stylesheet" href="/static/style.css">
    <script>
    // ë°œìŒ (Web Speech API)
    function speak(text) {
        if(window.speechSynthesis){
            var msg = new SpeechSynthesisUtterance(text);
            msg.lang = "en-US";
            window.speechSynthesis.speak(msg);
        }
    }
    </script>
</head>
<body>
<div class="header">ì˜ë‹¨ì–´ ì•”ê¸°ì¥</div>
<div class="nav-top">
    <form method="get" action="/" class="search-bar">
        <input type="text" name="q" value="{{ q }}" placeholder="ê²€ìƒ‰ (ë‹¨ì–´/ëœ»/ì˜ˆë¬¸/íƒœê·¸)">
        <select name="filter">
            <option value="all" {% if filter_mode=="all" %}selected{% endif %}>ì „ì²´</option>
            <option value="memorized" {% if filter_mode=="memorized" %}selected{% endif %}>ì•”ê¸°ì™„ë£Œë§Œ</option>
            <option value="not_memorized" {% if filter_mode=="not_memorized" %}selected{% endif %}>ë¯¸ì•”ê¸°ë§Œ</option>
        </select>
        <select name="sort">
            <option value="recent" {% if sort_mode=="recent" %}selected{% endif %}>ì¶”ê°€ìˆœ</option>
            <option value="alpha" {% if sort_mode=="alpha" %}selected{% endif %}>ì•ŒíŒŒë²³ìˆœ</option>
            <option value="memorized" {% if sort_mode=="memorized" %}selected{% endif %}>ì•”ê¸°ìƒíƒœ</option>
        </select>
        <button type="submit">ê²€ìƒ‰</button>
    </form>
    <div class="quick-links">
        <a href="/add">ë‹¨ì–´ ì¶”ê°€</a> |
        <a href="/bulk_add">ì—¬ëŸ¬ ë‹¨ì–´ ì¶”ê°€</a> |
        <a href="/quiz">í€´ì¦ˆ</a> |
        <a href="/flashcard">í”Œë˜ì‹œì¹´ë“œ</a> |
        <a href="/wrong_note">ì˜¤ë‹µë…¸íŠ¸</a> |
        <form action="/reset" method="post" style="display:inline;">
            <button type="submit" class="link-btn">ì•”ê¸°ì´ˆê¸°í™”</button>
        </form>
    </div>
</div>
<div class="stats">
    ì „ì²´: {{ total }} | ì•”ê¸°ì™„ë£Œ: {{ memorized }}
</div>
<div class="card-list">
    {% for w in words %}
    <div class="card{% if w.memorized %} memorized{% endif %}">
        <div style="display:flex; align-items:center;">
            <span class="word">{{ w.word }}</span>
            <button class="sound-btn" onclick="event.stopPropagation();speak('{{ w.word }}');">ğŸ”Š</button>
        </div>
        <div class="meaning">{{ w.meaning }}</div>
        {% if w.example %}
        <div class="ex-line">ì˜ˆë¬¸: <span class="example">{{ w.example }}</span></div>
        {% endif %}
        <div class="etc-info">
            {% if w.pos %}<span class="tag pos">{{ w.pos }}</span>{% endif %}
            {% if w.tags %}<span class="tag">{{ w.tags }}</span>{% endif %}
        </div>
        <div class="btns">
            {% if not w.memorized %}
            <button class="mini-btn" onclick="memorize('{{ w.word }}');event.stopPropagation();">ì•”ê¸°</button>
            {% endif %}
            <a href="/edit/{{ w.word }}" class="mini-btn" style="background:#ffde5a; color:#2c2c2c;">ìˆ˜ì •</a>
            <button class="mini-btn" onclick="deleteWord('{{ w.word }}');event.stopPropagation();">ì‚­ì œ</button>
        </div>
    </div>
    {% endfor %}
</div>
<script>
function memorize(word) {
    fetch(`/memorize/${word}`, { method: "POST" }).then(()=>location.reload());
}
function deleteWord(word) {
    if(confirm(word + " ë‹¨ì–´ë¥¼ ì •ë§ ì‚­ì œí• ê¹Œìš”?")) {
        fetch(`/delete/${word}`, { method: "POST" }).then(()=>location.reload());
    }
}
</script>
</body>
</html>
